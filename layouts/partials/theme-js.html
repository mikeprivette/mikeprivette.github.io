<script>
    function toggleTheme() {
        var html = document.documentElement;
        var next = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', next);
        try { localStorage.setItem('theme', next); } catch (e) {}
        updateToggle(next);
        updateThemeColor(next);
    }

    function updateToggle(theme) {
        var icon = document.getElementById('theme-icon');
        var label = document.getElementById('theme-label');
        if (icon) icon.textContent = theme === 'dark' ? '\u263C' : '\u263E';
        if (label) label.textContent = theme === 'dark' ? 'light' : 'dark';
    }

    function updateThemeColor(theme) {
        var meta = document.querySelector('meta[name="theme-color"]');
        if (meta) meta.setAttribute('content', theme === 'dark' ? '#0a0e14' : '#f6f5f0');
    }

    // Sync toggle UI and theme-color meta with the theme already set in <head>
    (function() {
        var theme = document.documentElement.getAttribute('data-theme') || 'dark';
        updateToggle(theme);
        updateThemeColor(theme);
    })();
</script>
